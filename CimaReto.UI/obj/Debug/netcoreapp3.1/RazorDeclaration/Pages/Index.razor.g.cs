#pragma checksum "C:\Users\Mario\source\repos\CimaReto\CimaReto.UI\Pages\Index.razor" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "59aba0490bd72bf1af49759a9ab4104926564269"
// <auto-generated/>
#pragma warning disable 1591
#pragma warning disable 0414
#pragma warning disable 0649
#pragma warning disable 0169

namespace CimaReto.UI.Pages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "C:\Users\Mario\source\repos\CimaReto\CimaReto.UI\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\Mario\source\repos\CimaReto\CimaReto.UI\_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\Mario\source\repos\CimaReto\CimaReto.UI\_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\Mario\source\repos\CimaReto\CimaReto.UI\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\Mario\source\repos\CimaReto\CimaReto.UI\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Users\Mario\source\repos\CimaReto\CimaReto.UI\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Users\Mario\source\repos\CimaReto\CimaReto.UI\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Users\Mario\source\repos\CimaReto\CimaReto.UI\_Imports.razor"
using CimaReto.UI;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "C:\Users\Mario\source\repos\CimaReto\CimaReto.UI\_Imports.razor"
using CimaReto.UI.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "C:\Users\Mario\source\repos\CimaReto\CimaReto.UI\_Imports.razor"
using BlazorContextMenu;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\Mario\source\repos\CimaReto\CimaReto.UI\Pages\Index.razor"
using CimaReto.UI.Data;

#line default
#line hidden
#nullable disable
    [Microsoft.AspNetCore.Components.RouteAttribute("/")]
    public partial class Index : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
        }
        #pragma warning restore 1998
#nullable restore
#line 138 "C:\Users\Mario\source\repos\CimaReto\CimaReto.UI\Pages\Index.razor"
       
    private Employee[] employee;
    public int PageSize { get; set; }
    public int TotalPages { get; set; }
    public int CurrentPage { get; set; }
    public List<Employee> list { get; set; }
    public List<Employee> filteredList { get; set; }
    public bool IsTableFiltered { get; set; }

    [Parameter]
    public bool ReloadList { get; set; }

    protected override async Task OnInitializedAsync()
    {
        PageSize = 5;

        employee = await EmployeeService.GetForecastAsync(DateTime.Now);
        list = filteredList = employee.Take(PageSize).ToList();
        TotalPages = (int)Math.Ceiling(employee.Count() / (decimal)PageSize);

        base.OnInitialized();
    }

    protected override void OnAfterRender(bool firstRender)
    {
        if (!firstRender && ReloadList)
        {
            UpdateList();
            ReloadList = false;

            StateHasChanged();
        }

        base.OnAfterRender(firstRender);
    }

    private void UpdateList(int pageNumber = 0)
    {
        list = filteredList = employee.Skip(pageNumber * PageSize).Take(PageSize).ToList();
        TotalPages = (int)Math.Ceiling(employee.Count() / (decimal)PageSize);
        CurrentPage = pageNumber;
    }

    private void NavigateTo(string direction)
    {
        if (direction == "prev" && CurrentPage != 0)
            CurrentPage -= 1;
        if (direction == "next" && CurrentPage != TotalPages - 1)
            CurrentPage += 1;
        if (direction == "first")
            CurrentPage = 0;
        if (direction == "last")
            CurrentPage = TotalPages - 1;

        UpdateList(CurrentPage);
    }

    private void UpdateListSearch(List<Employee> listado)
    {
        int pageNumber = 0;
        list = filteredList = listado.Skip(pageNumber * PageSize).Take(PageSize).ToList();
        CurrentPage = pageNumber;
    }

    private void OnSearchTextChanged(ChangeEventArgs changeEventArgs, string columnTitle)
    {
        string searchText = changeEventArgs.Value.ToString();
        IsTableFiltered = true;

        if (columnTitle == "Id")
            UpdateListSearch(employee.Where(wear => wear.Id.ToString().Contains(searchText)).ToList());
        if (columnTitle == "Name")
            UpdateListSearch(employee.Where(wear => wear.Name.Contains(searchText)).ToList());
        if (columnTitle == "LastName")
            UpdateListSearch(employee.Where(wear => wear.LastName.Contains(searchText)).ToList());
        if (columnTitle == "Direction")
            UpdateListSearch(employee.Where(wear => wear.Direction.Contains(searchText)).ToList());
    }

    public bool boolvalue { get; set; }

    void toggle()
    {
        boolvalue = !boolvalue;
    }

    async Task ReloadClick(ItemClickEventArgs e)
    {
        UpdateList();
    }

    void DeleteClick(ItemClickEventArgs e)
    {
        var currentRow = e.Data as Employee;
        list.Remove(currentRow);
        filteredList.Remove(currentRow);
    }

    async void message() {
        bool confirmed = await JsRuntime.InvokeAsync<bool>("confirm", "Success Link!");
    }

#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IJSRuntime JsRuntime { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private EmployeeService EmployeeService { get; set; }
    }
}
#pragma warning restore 1591
